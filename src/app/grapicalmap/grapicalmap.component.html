<div class="map-container">
  <!-- Product Selector -->
  <div class="product-selector">
    <div class="select-wrapper">
      <select [(ngModel)]="productCode" (change)="onProductChange($event)">
        <option *ngFor="let product of productCodes" [value]="product.value">
          {{ product.name }}
        </option>
      </select>
      <div class="select-arrow">▼</div>
    </div>
  </div>

  <!-- Custom Legend -->
  <div *ngIf="displayedLegend.length > 0" class="custom-legend">
    <div class="legend-header">
      <h4>Wind Speed (mph)</h4>
      <button class="legend-toggle" (click)="toggleLegendView()">
        {{ showFullLegend ? '▲' : '▼' }}
      </button>
    </div>
    
    <div class="legend-content">
      <div class="legend-color-bar">
        <div *ngFor="let entry of windSpeedLegend" 
             class="color-segment"
             [style.background-color]="entry.color"
             [title]="entry.value">
        </div>
      </div>
      
      <div class="legend-values">
        <div *ngFor="let entry of displayedLegend" class="legend-value-item">
          <span class="value-dot" [style.background-color]="entry.color"></span>
          <span class="value-text">{{ entry.value }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Time Control -->
  <div *ngIf="forecastTimes.length > 0" class="time-control">
    <div class="time-header">
      <button class="play-btn" (click)="toggleAnimation()">
        {{ isPlaying ? '⏸' : '▶' }}
      </button>
      <span class="time-display">{{ displayedTime }}</span>
    </div>
    
    <div class="slider-container">
      <input type="range" 
             [min]="0" 
             [max]="forecastTimes.length - 1" 
             [value]="forecastTimes.indexOf(selectedTime)"
             (input)="selectedTime = forecastTimes[$any($event.target).value]; addWmsLayer()"
             class="time-slider">
    </div>
  </div>

  <!-- Map -->
  <div id="map"></div>
</div>